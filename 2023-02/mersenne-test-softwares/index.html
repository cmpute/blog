<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="本文介绍如何利用CPU和GPU计算GIMPS任务。"><title>梅森素数测试软件教程 | JacobZ</title><link rel=canonical href=https://zyxin.xyz/blog/2023-02/mersenne-test-softwares/><link rel=stylesheet href=/blog/scss/style.min.ddd64a7f9075715264e9e9319381b9fbc3c8dfaa6c5e662ae63f5188bd252fbc.css><meta property="og:title" content="梅森素数测试软件教程"><meta property="og:description" content="本文介绍如何利用CPU和GPU计算GIMPS任务。"><meta property="og:url" content="https://zyxin.xyz/blog/2023-02/mersenne-test-softwares/"><meta property="og:site_name" content="JacobZ"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Windows"><meta property="article:tag" content="Volunteer Computing"><meta property="article:published_time" content="2023-02-22T00:00:00+00:00"><meta property="article:modified_time" content="2023-02-22T00:00:00+00:00"><meta name=twitter:title content="梅森素数测试软件教程"><meta name=twitter:description content="本文介绍如何利用CPU和GPU计算GIMPS任务。"><link rel="shortcut icon" href=/img/icon16.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/blog><img src=/blog/img/avatar_hua7c33bdc6ff69af7d15e47ee16119217_164168_300x0_resize_box_3.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>🐈</span></figure><div class=site-meta><h1 class=site-name><a href=/blog>JacobZ</a></h1><h2 class=site-description>的博客</h2></div></header><ol class=social-menu><li><a href=/blog/mailto:cmpute@foxmail.com target=_blank title=邮箱 rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-mail" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="3" y="5" width="18" height="14" rx="2"/><polyline points="3 7 12 13 21 7"/></svg></a></li><li><a href=/blog/index.xml target=_blank title=RSS订阅 rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></a></li><li><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://www.foreverblog.cn/go.html target=_blank title="虫洞 - 前往未知博客" rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-atom-2" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="3"/><line x1="12" y1="21" x2="12" y2="21.01"/><line x1="3" y1="9" x2="3" y2="9.01"/><line x1="21" y1="9" x2="21" y2="9.01"/><path d="M8 20.1A9 9 0 013 13"/><path d="M16 20.1a9 9 0 005-7.1"/><path d="M6.2 5a9 9 0 0111.4.0"/></svg></a></li><li><a href=https://www.travellings.cn/go.html target=_blank title="开往 - 前往随机博客" rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-train" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M21 13c0-3.87-3.37-7-10-7H3"/><path d="M3 15h16a2 2 0 002-2"/><path d="M3 6v5h17.5"/><line x1="3" y1="10" x2="3" y2="14"/><line x1="8" y1="11" x2="8" y2="6"/><line x1="13" y1="11" x2="13" y2="6.5"/><line x1="3" y1="19" x2="21" y2="19"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/blog/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>主页</span></a></li><li><a href=/blog/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-at" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="4"/><path d="M16 12v1.5a2.5 2.5.0 005 0V12a9 9 0 10-5.5 8.28"/></svg><span>关于</span></a></li><li><a href=/blog/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>归档</span></a></li><li><a href=/blog/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>搜索</span></a></li><div class=menu-bottom-section><li id=i18n-switch><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg><select name=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://zyxin.xyz/blog/en/>English</option><option value=https://zyxin.xyz/blog/ selected>中文</option></select></li><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>暗色模式</span></li></div></ol></aside><aside class="sidebar sticky right-sidebar"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#mprime-支持cpu上的所有任务><code>mprime</code>: 支持CPU上的所有任务</a></li><li><a href=#mfaktc-支持gpu上的tf任务><code>mfaktc</code>: 支持GPU上的TF任务</a></li><li><a href=#gpuowl-支持gpu上的prp任务><code>GpuOwl</code>: 支持GPU上的PRP任务</a></li><li><a href=#gpuowl--mprime-支持gpu上的pm1任务><code>GpuOwl</code> + <code>mprime</code>: 支持GPU上的PM1任务</a></li><li><a href=#任务类型之间的得分效率对比>任务类型之间的得分效率对比</a></li></ol></nav></div></section><section class="widget navbar"><a class=widget-link href=#comments-container><div class=widget-icon title=评论><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-messages" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M21 14l-3-3h-7a1 1 0 01-1-1V4a1 1 0 011-1h9a1 1 0 011 1v10"/><path d="M14 15v2a1 1 0 01-1 1H6l-3 3V11a1 1 0 011-1h2"/></svg></div><h2 class="widget-title section-title">评论</h2></a><div class=widget-link onclick='window.scrollTo({top:0,behavior:"smooth"})'><div class=widget-icon title=顶部><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrows-up" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="17" y1="3" x2="17" y2="21"/><path d="M4 6l3-3 3 3"/><path d="M20 6l-3-3-3 3"/><line x1="7" y1="3" x2="7" y2="21"/></svg></div><h2 class="widget-title section-title">顶部</h2></div><div class=widget-link id=toggle-sidebar-close><div class=widget-icon title=折叠><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-bar-right" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="20" y1="12" x2="10" y2="12"/><line x1="20" y1="12" x2="16" y2="16"/><line x1="20" y1="12" x2="16" y2="8"/><line x1="4" y1="4" x2="4" y2="20"/></svg></div><h2 class="widget-title section-title">折叠</h2></div><div class=widget-link id=toggle-sidebar-open><div class=widget-icon title=展开><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-bar-left" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="4" y1="12" x2="14" y2="12"/><line x1="4" y1="12" x2="8" y2="16"/><line x1="4" y1="12" x2="8" y2="8"/><line x1="20" y1="4" x2="20" y2="20"/></svg></div><h2 class="widget-title section-title">展开</h2></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/blog/categories/misc/ style=background-color:#273c2c;color:#fff>杂项</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/blog/2023-02/mersenne-test-softwares/>梅森素数测试软件教程</a></h2><h3 class=article-subtitle>本文介绍如何利用CPU和GPU计算GIMPS任务。</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>2023-02-22</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>阅读时长: 9 分钟</time></div></footer><footer class=article-translations><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg><div><a href=https://zyxin.xyz/blog/en/2023-02/mersenne-test-softwares/ class=link>English</a></div></footer></div></header><section class=article-content><details class="article-toc is-active"><summary class=article-toc-title><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg><span>目录</span><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-right" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><polyline points="9 6 15 12 9 18"/></svg></summary><div class=article-toc-body><nav id=TableOfContents-inline><ol><li><a href=#mprime-支持cpu上的所有任务><code>mprime</code>: 支持CPU上的所有任务</a></li><li><a href=#mfaktc-支持gpu上的tf任务><code>mfaktc</code>: 支持GPU上的TF任务</a></li><li><a href=#gpuowl-支持gpu上的prp任务><code>GpuOwl</code>: 支持GPU上的PRP任务</a></li><li><a href=#gpuowl--mprime-支持gpu上的pm1任务><code>GpuOwl</code> + <code>mprime</code>: 支持GPU上的PM1任务</a></li><li><a href=#任务类型之间的得分效率对比>任务类型之间的得分效率对比</a></li></ol></nav></div></details><p>最近又折腾了一下系统，顺便也就想尝试一下GIMPS别的跑法。本文总结了一下在GIMPS项目中推荐使用的几款软件以及它们的使用方法。关于什么是GIMPS，请参考<a class=link href=https://zyxin.xyz/blog/2021-11/utilize-your-computation-power/>我之前的文章</a>。GIMPS项目依赖PrimeNet网络进行任务的分发和收集，目前在测试新的梅森素数时PrimeNet会依次分配三种任务：<ruby>Trial<rt>T</rt>&nbsp;Factoring<rt>F</rt></ruby>、<ruby>P-1<rt>PM1</rt></ruby>分解和<ruby>Probable&nbsp;Prime<rt>PRP</rt></ruby>测试。因此本文主要介绍这三类任务的运行方法和推荐策略。</p><p>首先在跑这些测试的时候，如果你不想获得<ruby>分数<rt>credits</rt></ruby>则可以直接使用这些软件；但是我还是推荐在GIMPS网站上注册一个账号，以便访问PrimeNet自动获取和提交任务，这样是最高效地参与下一个梅森素数的寻找。</p><p>这些软件的使用一般都有两个方法，可以使用命令行参数输入也可以通过从<code>worktodo.txt</code>文件中读取。<code>worktodo.txt</code>里面任务的格式是由PrimeNet定义的，如果你从GIMPS官网<a class=link href=https://www.mersenne.org/manual_assignment/ target=_blank rel=noopener>手动下载任务</a>，那么获取到的是文本内容，每一行会定义一个任务。这样的文本放进<code>worktodo.txt</code>便可以被下文的软件所识别。</p><h2 id=mprime-支持cpu上的所有任务><code>mprime</code>: 支持CPU上的所有任务</h2><p><code>mprime</code>是GIMPS官方开发的素数测试软件，在Windows上它的另一个名字叫<code>prime95</code>（P95），被广泛地用于装机之后的压力测试。这个软件支持PrimeNet所有的计算任务，它只能使用CPU进行计算，但是它针对各种CPU都做了完备的优化，因此如果你想在CPU上运行素数测试直接去用官方的软件就好~</p><p><code>mprime</code>正式发布的版本可以在<a class=link href=https://www.mersenne.org/download/ target=_blank rel=noopener>GIMPS官网下载到</a>，而最新的测试版软件可以在镜像网站<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>下载到。</p><p>Linux下的<code>mprime</code>用命令行即可运行，在使用之前可能需要安装GMP高精度计算库（Ubuntu下运行<code>sudo apt install libgmp10</code>即可）；而Windows下<code>prime95</code>对应的库文件已经打包进去，不需要额外安装库。在第一次运行软件的时候，程序会首先提示加入PrimeNet，这是需要输入你在GIMPS上的用户名（注意这里不要输入昵称）。之后设置计算任务的偏好、每天运行的时间、使用多少CPU和内存等等。<code>mprime</code>里面有多个worker，每个worker可以运行不同的计算任务，并且会利用多个进程进行计算。调整每个worker的设置可以更细粒度地调整计算资源的分配。</p><blockquote><p>在Linux下使用<code>mprime</code>还有个需要注意的点是在第一次运行设置好之后，后面每次启动<code>mprime</code>就不会在命令行输出内容了。如果想继续使用菜单需要用<code>mprime -m</code>命令启动。</p></blockquote><h2 id=mfaktc-支持gpu上的tf任务><code>mfaktc</code>: 支持GPU上的TF任务</h2><p>GPU相比CPU更适合并行计算，而TF是其中很适合并行的任务，因此它的效率是最高的，也是GPU相比CPU最有优势的项目。而其他的两个任务在GPU上跑时程序只能利用GPU的FFT算法加速乘法计算，无法利用其他性能。</p><p>GPU计算TF目前大家都使用的软件是<code>mfaktc</code>（基于CUDA）和<code>mfakto</code>（基于OpenCL）。它们编译好的版本可以在镜像网站<sup id=fnref1:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>下载到。需要注意的是，镜像网站下载的版本对<code>mfaktc</code>有一定改进（主要是调整了一些参数以适应新显卡），因此如果你从源文件编译的话可以使用镜像里也提供的更改后的源码。另外，如果下载已经编译好的包的话需要安装对应版本的CUDA运行时。</p><p>它们的使用方法很简单，以<code>mfaktc</code>为例：从GIMPS官网下载任务后放在一个<code>worktodo.txt</code>文件里，然后在同目录运行<code>mfaktc</code>即可开始。最开始的时候<code>mfaktc</code>会有自检流程，如果你的显卡驱动或者硬件有问题，<code>mfaktc</code>会报错。这其实也是一种检查显卡有没有问题的方法hhh。</p><blockquote><p><code>mfaktc</code>也被一些BOINC上的素数寻找项目所使用，例如SRBase就利用这个软件分发任务给用户，并且它的TF结果也会上传回PrimeNet。因此如果你参与BOINC上的一些素数项目，它们也会给PrimeNet贡献结果，只是这些结果不会在计算到GIMPS里你的用户上面。</p></blockquote><h2 id=gpuowl-支持gpu上的prp任务><code>GpuOwl</code>: 支持GPU上的PRP任务</h2><p><code>GpuOwl</code>是由Mihal Preda编写的开源软件<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>，它是这几个GPU软件中唯一还在持续更新的软件，因此这里的教程也可能随着更新而失效。在写这篇博客的时候，<code>GpuOwl</code>的最新版本是v7.2。它在Windows下的可执行文件可以在镜像网站<sup id=fnref2:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>下载到，而Linux版则大概率是需要自己编译的</p><p><code>GpuOwl</code>支持PRP和PM1任务，但是它主要用途是利用GPU计算PRP任务。由于只有<code>GpuOwl</code>计算时可以提供PRP的证明文件，因此目前不推荐使用其他的同类软件（例如<code>CudaLucas</code>）。使用<code>GpuOwl</code>自带的<code>primenet.py</code>文件<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>可以实现自动任务获取和提交。</p><p><code>GpuOwl</code>支持多GPU计算，使用方法是启动多个<code>GpuOwl</code>进程，每个进程使用<code>-device</code>指定所使用的GPU，再使用<code>-pool</code>指定多个GPU共享的任务目录。把计算任务在这个目录的<code>worktodo.txt</code>文件里，每个<code>GpuOwl</code>都会按需从这个文件中获取任务进行计算。</p><h2 id=gpuowl--mprime-支持gpu上的pm1任务><code>GpuOwl</code> + <code>mprime</code>: 支持GPU上的PM1任务</h2><p>原生支持PM1任务的软件有<code>GpuOwl</code>和<code>CUDAPm1</code>，后者的代码快10年没什么更新了，而且只支持N卡，因此实际上好用的还是<code>GpuOwl</code>。<code>GpuOwl</code>在最近的更新之后支持一个骚操作，就是由它来计算PM1任务的一阶段，然后把结果导入到<code>mprime</code>里面计算二阶段。这样的话既可以利用GPU的计算能力，又可以利用大量的内存来计算二阶段（一般而言GPU的内存容量是小于主机RAM的，而计算二阶段时的内存是越多越好）。目前使用<code>GpuOwl</code>是无法直接得到PM1任务的结果的，因为代码里没有计算最后的最大公约数这一步，因此目前必须捆绑<code>mprime</code>使用。</p><p>具体的使用方法是在运行<code>GpuOwl</code>的时候指定<code>-mprimeDir</code>目录，将一阶段的计算结果以<code>mprime</code>可以读取的格式存到这个目录下。这个目录会生成每个指数对应的文件和一个<code>worktodo.add</code>文件。之后把这些文件拷贝到<code>mprime</code>所在目录下<code>mprime</code>就会识别这些任务并加到它自己的<code>worktodo.txt</code>里面。</p><blockquote><p>在使用者方法时可以考虑限制一下<code>mprime</code>不要获取新的任务，而是只跑<code>GpuOwl</code>生成的任务。按照<a class=link href="https://www.mersenneforum.org/showpost.php?p=619325&postcount=2873" target=_blank rel=noopener>作者的推荐</a>，可以在<code>mprime</code>同目录下的<code>prime.txt</code>中增加如下设置：</p><div class=codeblock><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=na>SequentialWorkToDo</span><span class=o>=</span><span class=s>1</span>
</span></span><span class=line><span class=cl><span class=na>MaxExponents</span><span class=o>=</span><span class=s>1000</span>
</span></span><span class=line><span class=cl><span class=na>UnreserveExponents</span><span class=o>=</span><span class=s>1000</span>
</span></span><span class=line><span class=cl><span class=na>NoMoreWork</span><span class=o>=</span><span class=s>1</span></span></span></code></pre></td></tr></table></div></div><div class=code-lang>INI</div></div></blockquote><h2 id=任务类型之间的得分效率对比>任务类型之间的得分效率对比</h2><p>如果你像我一样想在GIMPS上拿到更高的分数，那么有必要了解的是这三种的任务的得分效率是不同的。虽然GIMPS分数的计算是根据任务的计算量来的，但是由于硬件型号、软件优化等问题，这个工作量只能是一个估计值，而且它并不与实际所花时间成正相关。GIMPS的工作量单位是<ruby>Ghz-Days<rt>GHD</rt></ruby>，例如1GHD的计算量等价于1Ghz的CPU计算24小时达到的计算量。</p><p>根据我的经验，TF任务的得分效率最高、PM1次之、而PRP最低。我虽然没有做过CPU的实验，但是在GPU上我的经验是一张1080Ti左右的显卡，TF的得分效率可以达到700GHD每天，PM1的话有200到300，而PRP的效率只有100~200GHD每天。因此这三个任务的选择逻辑大概是：<strong>如果想拿到最多的分数就跑TF、如果想利用内存或者找到大因数就跑PM1、如果想成为发现下一个梅森素数的人就跑PRP</strong>。如果你想自己去测试效率的话可以<a class=link href=https://www.mersenne.ca/credit.php target=_blank rel=noopener>使用这个得分计算器</a>。</p><p>另外根据我的经验（主要是用GPU跑），每个任务分别的效率比较如下：</p><ul><li>TF：位数越低、指数越低则效率越高（也就是说PrimeNet的前沿任务是最高效的）<blockquote><p>根据<code>mfaktc</code>的估计值来看，用1080Ti跑73-74位数的时候，2亿左右的指数效率在每天750GHD左右，但是9亿就只有700GHD了。</p></blockquote></li><li>PM1: 指数越低、B2越高则效率越高。另外同指数情况下，得分主要由B2决定，因此最好设置B1为比较低的值。<blockquote><p>提供几个参考数据（用13700K和4090，GPU跑一阶段，CPU四线程跑二阶段）</p><div class=table-wrapper><table><thead><tr><th>指数</th><th>B1</th><th>B2</th><th>一阶段耗时</th><th>二阶段耗时</th><th>最终得分</th><th>得分效率</th></tr></thead><tbody><tr><td>1.19亿</td><td>240万</td><td>2.6亿</td><td>2小时</td><td>2.5小时</td><td>126GHD</td><td>28GHD/小时</td></tr><tr><td>1.19亿</td><td>320万</td><td>2.6亿</td><td>2.5小时</td><td>2.5小时</td><td>132GHD</td><td>26GHD/小时</td></tr><tr><td>3.32亿</td><td>320万</td><td>2.1亿</td><td>7小时</td><td>19.5小时</td><td>362GHD</td><td>13.6GHD/小时</td></tr><tr><td>3.32亿</td><td>320万</td><td>1.8亿</td><td>7小时</td><td>18.5小时</td><td>323GHD</td><td>12.7GHD/小时</td></tr></tbody></table></div></blockquote></li><li>PRP：似乎指数越高则效率越高，但是差距不是很大<blockquote><p>RTX4080上1.13亿左右的指数需要跑53个小时，得分大概500GHD，效率为每小时9.4GHD；而3.32亿左右的指数跑需要500小时，得分大概5000GHD，效率为每小时10GHD。</p></blockquote></li></ul><hr><p>本文粗略地介绍了以上这些软件的用法，如有更高级的需要可以参考各软件自带的说明文件（都很简陋），或者Mersenne论坛的<a class=link href="https://mersenneforum.org/showthread.php?t=24607" target=_blank rel=noopener>这一篇总结帖</a>。</p><p>我目前个人使用的策略如下：</p><ul><li>TF：仅GPU运行。通过<a class=link href=https://www.mersenne.org/primenet/ target=_blank rel=noopener>任务分工表</a>寻找目前最小指数的TF任务，然后手动领任务。</li><li>PM1：CPU使用<code>mprime</code>自动获取最小指数的PM1任务，GPU选择最小指数的PM1任务、以及一亿位以上梅森数里面B1较小的<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>。</li><li>PRP：仅GPU运行。通过<code>GpuOwl</code>自动获取最小指数的PRP任务和一亿位以上梅森数的任务。</li></ul><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>由James Heinrich搭建的<a class=link href=https://www.mersenne.ca/ target=_blank rel=noopener><code>mersenne.ca</code></a>网站提供了很多与GIMPS相关的工具、数据和排名。它还提供基本所有<a class=link href=https://download.mersenne.ca/ target=_blank rel=noopener>非官方的计算软件下载</a>。&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref1:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref2:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>GpuOwl的Github地址为<a class=link href=https://github.com/preda/gpuowl target=_blank rel=noopener>github.com/preda/gpuowl</a>。&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p><code>primenet.py</code>里面可以指定要获取的任务，任务名称的定义可以参见GIMPS官网的<a class=link href=https://www.mersenne.org/worktypes/ target=_blank rel=noopener>任务类型页面</a>&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p>如果想寻找一亿位以上梅森数还没有跑过PM1的指数，可以从<a class=link href="https://www.mersenne.org/report_factoring_effort/?exp_lo=332192809&exp_hi=334000000&bits_lo=81&bits_hi=81&txt=1&prp=-1&pm1=-1" target=_blank rel=noopener>这个链接</a>获取。&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></section><footer class=article-footer><section class=article-tags><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-tag" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11 3l9 9a1.5 1.5.0 010 2l-6 6a1.5 1.5.0 01-2 0L3 11V7a4 4 0 014-4h4"/><circle cx="9" cy="9" r="2"/></svg><span><a href=/blog/tags/linux/>#Linux</a><a href=/blog/tags/windows/>#Windows</a><a href=/blog/tags/volunteer-computing/>#Volunteer Computing</a></span></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>相关文章</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/blog/2021-11/utilize-your-computation-power/><div class=article-image><img src=/blog/2021-11/utilize-your-computation-power/primenet-ranking.bec294915dd0425f0d61044da5a353fc.png width=1212 height=191 loading=lazy alt="Featured image of post 冬日取暖最佳方式 — 利用闲置的计算资源" data-hash="md5-vsKUkV3QQl8NYQRNpaNT/A=="></div><div class=article-details><h2 class=article-title>冬日取暖最佳方式 — 利用闲置的计算资源</h2></div></a></article><article><a href=/blog/2021-07/mega-fav-numbers/><div class=article-details><h2 class=article-title>MegaFavNumbers - 最喜爱的百万数字</h2></div></a></article><article><a href=/blog/2020-12/audiophile-introduction/><div class=article-details><h2 class=article-title>“音频发烧友” / “Audiophile” 入门及杂谈</h2></div></a></article><article class=has-image><a href=/blog/2018-09/linux-dual-system/><div class=article-image><img src=/blog/2018-09/linux-dual-system/drive_manage.f2cb7cee1dbc2204f1c55df5d287f67c.png width=760 height=245 loading=lazy alt="Featured image of post 安装Windows与Linux（Ubuntu 16.04）双系统并搭建工作环境" data-hash="md5-8st87h28IgTxxV310of2fA=="></div><div class=article-details><h2 class=article-title>安装Windows与Linux（Ubuntu 16.04）双系统并搭建工作环境</h2></div></a></article></div></div></aside><link rel=stylesheet href=/blog/scss/partials/comments/giscus.min.css><div class=giscus-container id=comments-container><script src=https://giscus.app/client.js data-repo=cmpute/blog data-repo-id=R_kgDOIxqBHQ data-category=Announcements data-category-id=DIC_kwDOIxqBHc4CTl1Y data-mapping=title data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=en crossorigin=anonymous async></script>
<script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"light":"dark")}})()</script></div><div class=bottom-navbar-container><div class=bottom-navbar><a class=bottom-navbar-icon href=#comments-container><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-messages" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M21 14l-3-3h-7a1 1 0 01-1-1V4a1 1 0 011-1h9a1 1 0 011 1v10"/><path d="M14 15v2a1 1 0 01-1 1H6l-3 3V11a1 1 0 011-1h2"/></svg></a><div class=bottom-navbar-icon onclick='window.scrollTo({top:0,behavior:"smooth"})'><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrows-up" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="17" y1="3" x2="17" y2="21"/><path d="M4 6l3-3 3 3"/><path d="M20 6l-3-3-3 3"/><line x1="7" y1="3" x2="7" y2="21"/></svg></div></div></div><footer class=site-footer><section class=copyright>&copy;
2017 -
2023 JacobZ</section><section class=powerby>使用 <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> 构建<br>主题 <b><a href=https://github.com/cmpute/hugo-theme-stacked target=_blank rel=noopener data-version=3.16.0>Stacked</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计，Jacob 修改</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/blog/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>